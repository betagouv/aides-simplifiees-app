# Plan: Frontend Unit Testing with Vitest

## Date
Created: 2025-11-01

## Context
The project had only backend unit tests (Japa) and E2E tests (Playwright). Frontend utilities, composables, and components needed proper unit testing infrastructure with native Vite support.

## Objectives
- [x] Set up Vitest for frontend unit testing
- [x] Configure Vue Test Utils integration
- [x] Add test directory structure
- [x] Configure coverage reporting
- [x] Add npm scripts for testing
- [x] Document setup and usage

## Implementation

### Vitest Configuration
Created `vitest.config.ts` with:
- Vue plugin for component testing
- happy-dom as lightweight DOM environment
- Vite alias support (~ resolves to ./inertia)
- Test file patterns: tests/frontend/**/*.{test,spec}.{js,ts}
- Coverage with v8 provider (text/html/lcov reporters)

### Directory Structure
Created `tests/frontend/` for:
- Utils tests: tests/frontend/utils/
- Composables tests: tests/frontend/composables/
- Component tests: tests/frontend/components/
- Store tests: tests/frontend/stores/

### Dependencies Added
- vitest@4.0.6: Test framework
- @vue/test-utils@2.4.6: Vue component testing
- happy-dom@20.0.10: Lightweight DOM implementation
- @vitest/coverage-v8@4.0.6: Coverage reporting

### Scripts Added
- `pnpm test:frontend`: Run frontend unit tests
- `pnpm test:frontend:ui`: Open Vitest UI for interactive testing
- `pnpm test:frontend:coverage`: Run tests with coverage report
- `pnpm test:all`: Run all test suites (backend + frontend + E2E)

## Benefits
- **Native Vite Support**: Resolves Vite aliases (~) without configuration
- **Fast**: HMR and instant feedback
- **Isolated**: Separate from backend test environment
- **Modern**: Vue 3 Composition API support
- **Coverage**: Built-in coverage reporting
- **Developer Experience**: UI mode for debugging

## Usage Examples

### Running Tests
```bash
# Run all frontend tests
pnpm test:frontend

# Run tests in watch mode
pnpm test:frontend -- --watch

# Run tests with UI
pnpm test:frontend:ui

# Run with coverage
pnpm test:frontend:coverage

# Run specific test file
pnpm test:frontend -- request_builder.spec.ts
```

### Writing Tests
```typescript
// tests/frontend/utils/example.spec.ts
import { describe, it, expect } from 'vitest'
import { myFunction } from '~/utils/example'

describe('myFunction', () => {
  it('should do something', () => {
    const result = myFunction('input')
    expect(result).toBe('expected')
  })
})
```

### Testing Vue Components
```typescript
// tests/frontend/components/example.spec.ts
import { describe, it, expect } from 'vitest'
import { mount } from '@vue/test-utils'
import MyComponent from '~/components/MyComponent.vue'

describe('MyComponent', () => {
  it('renders correctly', () => {
    const wrapper = mount(MyComponent, {
      props: { title: 'Test' }
    })
    expect(wrapper.text()).toContain('Test')
  })
})
```

## Files Created
- vitest.config.ts (28 lines)
- tests/frontend/.gitkeep (directory marker)

## Files Modified
- package.json: Added dependencies and scripts
- pnpm-lock.yaml: Locked Vitest dependencies

## Testing Strategy
- **Unit Tests**: Isolated function/composable testing
- **Component Tests**: Vue component rendering and interaction
- **Integration Tests**: Multiple components/utilities working together
- **No E2E**: Keep E2E tests in Playwright (tests/e2e/)

## Future Enhancements
- Add more utility tests as needed
- Test composables with Vue runtime
- Component interaction testing
- Store testing with Pinia
- Snapshot testing for components

## History
- 2025-11-01: Initial Vitest setup with Vue Test Utils
- 2025-11-01: Created directory structure and documentation
